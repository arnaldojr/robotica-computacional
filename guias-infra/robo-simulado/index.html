<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
      
        <title>Primeiros passos com o Robô Simulado - Robótica Computacional - Insper</title>
      
    
    <link rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Fira+Sans+Extra+Condensed:700|Oxygen+Mono|Source+Sans+Pro:700|Source+Serif+Pro&amp;display=swap">
    <link rel="stylesheet" href="../../assets/css/main.css">
    <script>
      // SETUP GLOBAL CONSTANTS
      var base_url = '../..';
      
      var telemetryEnabled = false;
      var backendUrl = "";
      var courseSlug = "";
      
      
      var dashboardEnabled = false;
      var tagTree = {};
      

      // SETUP PLUGIN
      window.initialized = false;
      if (!window.initializers) window.initializers = [];
      window.registerInitializer = (initialize) => {
        if (window.initialized) initialize();
        else window.initializers.push(initialize);
      };
    </script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          processEscapes: true
        }
      });
    </script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="https://unpkg.com/hyperscript.org"></script>
    <script src="https://unpkg.com/htmx.org@1.8.4"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="../../assets/js/main.js"></script>
    
    <link rel="stylesheet" href="../../equipe.css"><link rel="stylesheet" href="../../css/ansi-colours.css"><link rel="stylesheet" href="../../css/jupyter-cells.css"><link rel="stylesheet" href="../../css/pandas-dataframe.css">
  </head>
  <body>
    <div class="ah-main-container">
      <header class="ah-header">
        <button class="ah-menu-btn ah-button ah-button--borderless"
                aria-label="toggle menu">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
  <!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
  <path d="M0 96C0 78.3 14.3 64 32 64H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 128 0 113.7 0 96zM0 256c0-17.7 14.3-32 32-32H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H32c-17.7 0-32-14.3-32-32zM448 416c0 17.7-14.3 32-32 32H32c-17.7 0-32-14.3-32-32s14.3-32 32-32H416c17.7 0 32 14.3 32 32z"/>
</svg>
        </button>
        <a href="../.."
           title="Robótica Computacional - Insper"
           class="ah-logo"
           aria-label="Robótica Computacional - Insper">
          Robótica Computacional - Insper
        </a>
        <div class="ah-header--right">
          
          
          
          <button id="resetHandoutButton">
            <span class="icon"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" class="bi bi-trash3" viewBox="0 0 16 16">
  <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"/>
</svg></span>
          </button>
          

          
        </div>
      </header>
      <nav class="ah-navigation preload">
        <div class="ah-nav-container">
          <button class="ah-menu-btn ah-button ah-button--borderless close-menu"
                  aria-label="close menu">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512">
  <!--! Font Awesome Pro 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. -->
  <path d="M310.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L160 210.7 54.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L114.7 256 9.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 301.3 265.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L205.3 256 310.6 150.6z"/>
</svg>
          </button>
          <ul class="ah-nav-body">
            
              
  
    <li>
      <a href="../..">Robótica Computacional 2023/1</a>
    </li>
  

            
              
  <li class="ah-togglable-item opened">
    <span class="ah-togglable-handle">Infra</span>
    <ul>
      
        
  
    <li>
      <a href="../">Comece aqui</a>
    </li>
  

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Linux</span>
    <ul>
      
        
  
    <li>
      <a href="../ssd-linux/">Início</a>
    </li>
  

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Primeiro boot com SSD</span>
    <ul>
      
        
  
    <li>
      <a href="../ssd-linux/recebi-meu-ssd/">Início</a>
    </li>
  

      
        
  
    <li>
      <a href="../ssd-linux/recebi-meu-ssd/windows/">Windows</a>
    </li>
  

      
        
  
    <li>
      <a href="../ssd-linux/recebi-meu-ssd/mac-os/">macOS (intel)</a>
    </li>
  

      
    </ul>
  </li>

      
        
  
    <li>
      <a href="../ssd-linux/primeiros-passos/">Meu SSD subiu, e agora?</a>
    </li>
  

      
        
  
    <li>
      <a href="../ssd-linux/guia-linux/">Guia básico de Linux</a>
    </li>
  

      
        
  
    <li>
      <a href="../ssd-linux/git-e-github/">Configure o seu Git</a>
    </li>
  

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item opened">
    <span class="ah-togglable-handle">Robô Simulado</span>
    <ul>
      
        
  
    <li class="active ah-togglable-item opened">
      <span class="ah-togglable-handle">Primeiros passos com o Robô Simulado</span>
      <ul>
        
      </ul>
    </li>
  

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Robô TurtleBot3</span>
    <ul>
      
        
  
    <li>
      <a href="../turtlebot3/">Conectando no robô físico</a>
    </li>
  

      
    </ul>
  </li>

      
        
  
    <li>
      <a href="../aps/">Configuração da APS</a>
    </li>
  

      
        
  
    <li>
      <a href="../checagem/">Conferência da Infra</a>
    </li>
  

      
    </ul>
  </li>

            
              
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Módulos</span>
    <ul>
      
        
  
    <li>
      <a href="../../modulos/">Módulos do curso</a>
    </li>
  

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">00 - Introdução</span>
    <ul>
      
        
  
    <li>
      <a href="../../modulos/00-intro/">Sobre o curso</a>
    </li>
  

      
        
  
    <li>
      <a href="../../modulos/00-intro/atividade-dia1/">Atividades dia 1</a>
    </li>
  

      
        
  
    <li>
      <a href="../../modulos/00-intro/recursos-legais/">Para saber mais</a>
    </li>
  

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">01 - Imagens e Matrizes</span>
    <ul>
      
        
  
    <li>
      <a href="../../modulos/01-imagens-e-matrizes/">01 - Imagens e Matrizes</a>
    </li>
  

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Atividades</span>
    <ul>
      
        
  
    <li>
      <a href="../../modulos/01-imagens-e-matrizes/atividade1/">Leitura de imagens</a>
    </li>
  

      
        
  
    <li>
      <a href="../../modulos/01-imagens-e-matrizes/atividade2/">Percorrendo a imagem</a>
    </li>
  

      
        
  
    <li>
      <a href="../../modulos/01-imagens-e-matrizes/atividade3/">Cookbook de Numpy</a>
    </li>
  

      
        
  
    <li>
      <a href="../../modulos/01-imagens-e-matrizes/atividade4/">Segmentação de imagens por cor</a>
    </li>
  

      
    </ul>
  </li>

      
    </ul>
  </li>

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">02 - Modelo de Câmera</span>
    <ul>
      
        
  
    <li>
      <a href="../../modulos/02-modelo-de-camera/">02 - Modelos de câmera</a>
    </li>
  

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Atividades</span>
    <ul>
      
        
  
    <li>
      <a href="../../modulos/02-modelo-de-camera/atividade1/">Segmentação usando HSV e contornos</a>
    </li>
  

      
        
  
    <li>
      <a href="../../modulos/02-modelo-de-camera/atividade2/">Morfologia matemática</a>
    </li>
  

      
        
  
    <li>
      <a href="../../modulos/02-modelo-de-camera/atividade3/">Demonstração de segmentação</a>
    </li>
  

      
    </ul>
  </li>

      
    </ul>
  </li>

      
        
  
    <li>
      <a href="../../modulos/03-visao/">03 - Visão</a>
    </li>
  

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">04 - ROS Básico</span>
    <ul>
      
        
  
    <li>
      <a href="../../modulos/04-ROS-basico/">04 - ROS básico</a>
    </li>
  

      
        
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Atividades</span>
    <ul>
      
        
  
    <li>
      <a href="../../modulos/04-ROS-basico/atividades/atividade1/">Simulador do Turtlebot</a>
    </li>
  

      
        
  
    <li>
      <a href="../../modulos/04-ROS-basico/atividades/atividade2/">Tópicos e mensagens na ROS</a>
    </li>
  

      
        
  
    <li>
      <a href="../../modulos/04-ROS-basico/atividades/atividade3/">Visualização da ROS</a>
    </li>
  

      
        
  
    <li>
      <a href="../../modulos/04-ROS-basico/atividades/atividade4/">Lista de exercícios da ROS</a>
    </li>
  

      
    </ul>
  </li>

      
    </ul>
  </li>

      
    </ul>
  </li>

            
              
  <li class="ah-togglable-item">
    <span class="ah-togglable-handle">Revisões</span>
    <ul>
      
        
  
    <li>
      <a href="../../revisao-PI/">Revisão PI</a>
    </li>
  

      
    </ul>
  </li>

            
          </ul>
        </div>
      </nav>
      <main class="ah-content ah-typeset">
        
          <div class="ah-title-box">
            <ul class="ah-breadcrumbs">
              
                
                  
                    <li>Infra</li>
                  
                
                  
                    <li>Robô Simulado</li>
                  
                
                <li>Primeiros passos com o Robô Simulado</li>
            </ul>
            
            
          </div>
          
            <section class="progress-section show">
<h1 id="primeiros-passos-com-o-robo-simulado">Primeiros passos com o Robô Simulado</h1>
<p>Neste guia iremos executar comandos para rodar o simulador usado na disciplina. O objetivo aqui é verificar se está tudo funcionando. Várias coisas serão um pouco misteriosas por enquanto, mas ficarão claras durante o semestre. </p>
<h2 id="configurando-o-arquivo-bashrc">Configurando o arquivo .bashrc</h2>
<p>O arquivo ~/.bashrc é excutado toda vez que abrimos um terminal. Nele podemos colocar configurações personalizadas para cada usuário. O SSD de robótica tem coisas úteis para as disciplinas de robótica el elementos. </p>
<div class="admonition tip">
<p class="admonition-title">Dica 1</p>
<p>Usamos o <code>~</code> comouma abreviação para a pasta <code>home</code> do usuário atual. No nosso caso, é equivalente a digitar <code>/home/borg/</code></p>
</div>
<details class="details">
<summary>Details</summary>
<p>BASH significa Bourne Again Shell. Há um número de shells diferentes, incluindo csh, zsh, dash e korn.</p>
<p>Um shell é um interpretador que executa operações como navegar por um sistema de arquivos, executar programas, modificar permissões, enfim, é uma ferramenta importante do sistema operacional.</p>
</details>
<div class="admonition tip">
<p class="admonition-title">Dica 2</p>
<p>O arquivo ~/.bashrc é um arquivo oculto, por isso tem um “.” no início do nome.</p>
</div>
<p>Para editar seu .bashrc, abra um terminal (<kbd>Ctrl</kbd> + <kbd>Alt</kbd> + <kbd>T</kbd>) e use o comando abaixo:</p>
<div class="highlight"><pre><span></span><code>gedit<span class="w"> </span>~/.bashrc
</code></pre></div>
<p>Perceba que lá no final do arquivo, temos algo como;</p>
<div class="highlight"><pre><span></span><code><span class="c1">##########################</span>
<span class="c1"># 3s</span>
<span class="c1">##########################</span>

<span class="nb">source</span><span class="w"> </span>~/elementos.sh
<span class="nb">source</span><span class="w"> </span>~/robotica.sh
</code></pre></div>
<p>Isso é porque estamos ativando esses arquivos que estão localizados na home, o <em>elementos.sh</em> e o , <em>robotica.sh</em>. Eles definem configurações especificas para o ambiente, tanto da matéria de Robótica, como da matéria de Elementos de Sistemas.</p>
<p>É preciso abrir o arquivo <em>robotica.sh</em> para definir as configurações que permitem o acesso ao Insperbot simulado. Abra um terminal (<kbd>Ctrl</kbd> + <kbd>Alt</kbd> + <kbd>T</kbd>)e use o comando a seguir para editar o arquivo robotica.sh</p>
<div class="highlight"><pre><span></span><code>gedit<span class="w"> </span>~/robotica.sh
</code></pre></div>
<p>Certifique-se de que as linhas 7 e 8 estão comentadas no seu arquivo robotica.sh.  Se não estiverem, comente colocando um <code>#</code> na frente da linha, salve e feche o arquivo.</p>
<p><img alt="Untitled" src="imgs/Untitled.png" /></p>
<p>Abra um novo terminal para recarregar as configurações do .bashrc que chama o arquivo <em>robotica.sh</em> (<kbd>Ctrl</kbd> + <kbd>Alt</kbd> + <kbd>T</kbd>)</p>
<h2 id="abrindo-o-simulador">Abrindo o simulador</h2>
<p>Execute o comando abaixo em um terminal novo para subir o cenário pista_s2 no simulador Gazebo.</p>
<div class="highlight"><pre><span></span><code>roslaunch<span class="w"> </span>my_simulation<span class="w"> </span>pista_s2.launch
</code></pre></div>
<p>O seu terminal vai exibir algo parecido com isso:</p>
<p><img alt="Untitled" src="imgs/Untitled1.png" /></p>
<div class="admonition warning">
<p class="admonition-title">Atenção</p>
<p>Não feche o terminal, o gazebo está sendo executado através dele, se precisar usar o terminal, é melhor abrir um novo e deixar esse quietinho.</p>
</div>
<p><img alt="Untitled" src="imgs/Untitled2.png" /></p>
<p>Essa é a janela do Gazebo, o nosso simulador, com ele podemos simular o comportamento do robô, dos seus sensores, câmera, garra, quanto dos objetos como os creepers, arucos ou caixas coloridas. O ROS não sabe diferenciar se os dados estão vindo de um robô simulado ou se estão vindo de um robô real. É dessa forma porque os dados dos sensores chegam para o ROS através de tópicos, também é pelos tópicos que nós conseguimos enviar comandos para os motores ou para a garra do robô, isso é interessante porque via código o tratamento dos dados é bem parecido, tanto no robô real quanto no robô simulado. Para saber quais são os tópicos disponíveis para o ROS, abra um novo terminal  (<kbd>Ctrl</kbd> + <kbd>Alt</kbd> + <kbd>T</kbd>) e use o comando:</p>
<div class="highlight"><pre><span></span><code>rostopic<span class="w"> </span>list
</code></pre></div>
<p>Uma lista de tópicos como essa vai aparecer pra você no terminal:</p>
<p><img alt="Untitled" src="imgs/Untitled3.png" /></p>
<p>Conseguimos “escutar” os dados dos sensores que estão chegando via ROS usando o comando <strong>rostopic echo nome_do_topico</strong></p>
<div class="highlight"><pre><span></span><code>rostopic<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>imu
</code></pre></div>
<p><img alt="Untitled" src="imgs/Untitled4.png" /></p>
<p>Se quiser parar de acessar os dados da IMU do robô simulado, use o <kbd>Ctrl</kbd> + <kbd>C</kbd> </p>
<p>Para abrir a câmera do robô use o comando:</p>
<div class="highlight"><pre><span></span><code>rqt_image_view
</code></pre></div>
<p>Se a imagem não aparecer, provavelmente você está escutando um tópico fantasma, basta trocar a opção para acessar o tópico certo, conforme imagem abaixo:</p>
<p><img alt="Untitled" src="imgs/Untitled5.png" /></p>
<p>Com o comando abaixo, podemos publicar valores de velocidade angular e linear direto no robô simulado</p>
<p>Em um novo terminal, utilize o comando fazer o robô andar loucamente:</p>
<div class="highlight"><pre><span></span><code>rostopic<span class="w"> </span>pub<span class="w"> </span>-1<span class="w"> </span>cmd_vel<span class="w"> </span>geometry_msgs/Twist<span class="w"> </span><span class="s1">&#39;[4.0, 0.0, 0.0]&#39;</span><span class="w"> </span><span class="s1">&#39;[0.0, 0.0, 0.0]&#39;</span>
</code></pre></div>
<p><img alt="robo_descontrolado.gif" src="imgs/robo_descontrolado.gif" /></p>
<p>Com o mesmo comando, podemos enviar 0 para os motores, parando o robô, <strong>este comando pode ser útil em momentos de emergência</strong>.</p>
<div class="highlight"><pre><span></span><code>rostopic<span class="w"> </span>pub<span class="w"> </span>-1<span class="w"> </span>cmd_vel<span class="w"> </span>geometry_msgs/Twist<span class="w"> </span><span class="s1">&#39;[0.0, 0.0, 0.0]&#39;</span><span class="w"> </span><span class="s1">&#39;[0.0, 0.0, 0.0]&#39;</span>
</code></pre></div>
<p><img alt="parando_robo.gif" src="imgs/parando_robo.gif" /></p>
<p>Também conseguimos teleoperar o robô com o comando abaixo:</p>
<div class="highlight"><pre><span></span><code>roslaunch<span class="w"> </span>turtlebot3_teleop<span class="w"> </span>turtlebot3_teleop_key.launch
</code></pre></div>
<p>Para controlar o robô, use </p>
<ul>
<li><strong>w</strong> para ir para frente</li>
<li><strong>s</strong> para parar o robô</li>
<li><strong>a</strong> para ir para esquerda &lt;</li>
<li><strong>d</strong> para ir para direita &gt;</li>
<li><strong>x</strong> para dar ré</li>
</ul>
<p>É importante que você mantenha o terminal ativo para conseguir teleoperar o robô (clicando no terminal pra ativar ele)</p>
<p><img alt="robo_andando.gif" src="imgs/robo_andando.gif" /></p>
<p>Foi divertido, porém, vamos controlar o robô via código não é mesmo?</p>
<p>Se estiver com o teleop aberto, mate o terminal, clicando no terminal que está com o comando do teleop e apertando as teclas <kbd>Ctrl</kbd> + <kbd>C</kbd>. Não é legal ter lugares diferentes enviando comandos para o robô, normalmente dá conflito.</p>
<h2 id="controlando-o-robo-via-codigo">Controlando o robô via código</h2>
<p>Agora, com tudo limpo, tudo em paz, crie um arquivo python em branco e cole o código abaixo.</p>
<p>Para criar o arquivo:</p>
<div class="highlight"><pre><span></span><code>code<span class="w"> </span>~/roda_robozinho.py
</code></pre></div>
<p>Para dar permissão de execução para o arquivo:</p>
<div class="highlight"><pre><span></span><code>chmod<span class="w"> </span>a+x<span class="w"> </span>~/roda_robozinho.py
</code></pre></div>
<p>Código em python que faz o robô andar em círculos eternamente:</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python3</span>

import<span class="w"> </span>rospy
from<span class="w"> </span>geometry_msgs.msg<span class="w"> </span>import<span class="w"> </span>Twist
import<span class="w"> </span>sys

<span class="c1">#função que publica valores de velocidade no robô</span>
def<span class="w"> </span>move_robot<span class="o">(</span>lin_vel,ang_vel,sleep<span class="o">)</span>:
<span class="w">    </span><span class="c1">#inicializando um node no ROS</span>
<span class="w">    </span>rospy.init_node<span class="o">(</span><span class="s1">&#39;move_robot&#39;</span>,<span class="w"> </span><span class="nv">anonymous</span><span class="o">=</span>True<span class="o">)</span><span class="w"> </span>

<span class="w">    </span><span class="c1">#definindo o tópico que será utilizado pela função, o tipo da mensagem e o </span>
<span class="w">    </span><span class="c1">#tamanho da fila de mensagens que serão enviadas para o tópico definido</span>
<span class="w">        </span><span class="c1">#no caso é cmd_vel, topico do tipo publisher que controla os motores do robô</span>
<span class="w">    </span><span class="nv">pub</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>rospy.Publisher<span class="o">(</span><span class="s1">&#39;cmd_vel&#39;</span>,<span class="w"> </span>Twist,<span class="w"> </span><span class="nv">queue_size</span><span class="o">=</span><span class="m">3</span><span class="o">)</span>

<span class="w">        </span><span class="c1">#definindo um metodo to tipo Twist()</span>
<span class="w">        </span><span class="c1">#http://docs.ros.org/en/noetic/api/geometry_msgs/html/msg/Twist.html</span>
<span class="w">    </span><span class="nv">vel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Twist<span class="o">()</span><span class="w">       </span>

<span class="w">    </span>vel.linear.x<span class="w"> </span><span class="o">=</span><span class="w"> </span>lin_vel<span class="w"> </span><span class="c1"># Velocidade linear (eixo x)</span>
<span class="w">    </span>vel.linear.y<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<span class="w">    </span>vel.linear.z<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>

<span class="w">    </span>vel.angular.x<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<span class="w">    </span>vel.angular.y<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span>
<span class="w">    </span>vel.angular.z<span class="w"> </span><span class="o">=</span><span class="w"> </span>ang_vel<span class="w">  </span><span class="c1"># Velocidade angular (eixo z)</span>

<span class="w">        </span><span class="c1"># exibindo no terminal a velocidade linear e a velocidade angular atual</span>
<span class="w">    </span>rospy.loginfo<span class="o">(</span><span class="s2">&quot;Linear Vel = %f: Angular Vel = %f&quot;</span>,lin_vel,ang_vel<span class="o">)</span>
<span class="w">        </span><span class="c1"># publicando a velocidade via ROS no robô</span>
<span class="w">    </span>pub.publish<span class="o">(</span>vel<span class="o">)</span>
<span class="w">        </span><span class="c1"># aguardando um tempinho para dar tempo de executar o comando</span>
<span class="w">    </span>rospy.sleep<span class="o">(</span>sleep<span class="o">)</span>

<span class="k">if</span><span class="w"> </span><span class="nv">__name__</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;__main__&#39;</span>:

<span class="w">     </span><span class="k">while</span><span class="w"> </span>not<span class="w"> </span>rospy.is_shutdown<span class="o">()</span>:<span class="w"> </span><span class="c1">#loop do ROS</span>
<span class="w">                </span><span class="c1">#enviando os valores de velocidade para a função move_robot</span>
<span class="w">        </span>move_robot<span class="o">(</span><span class="m">0</span>.5,0.5,0.5<span class="o">)</span><span class="w"> </span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Dica 3</p>
<p>Você pode executarseu programa tanto com <code>python3 ~/roda_robozinho.py</code> quanto com <code>~/roda_robozinho.py</code>. Isso é possível pois demos permissão de execução ao programa (com o comando <code>chmod</code> acima) e colocamos na primeira linha que queremos executar esse programa usando o comando <code>python3</code></p>
</div>
<p>O seu resultado deve ser algo parecido com isso:</p>
<p><img alt="robo_python.gif" src="imgs/robo_python.gif" /></p>
<h2 id="parando-o-robo">Parando o robô</h2>
<p>Para interromper o programa, use o  <kbd>Ctrl</kbd> + <kbd>C</kbd>, você perceberá que o robô continuará girando loucamente, apesar de não existir mais um programa sendo executado. Isso acontece porquê o robô mantém em execução o último comando enviado. Se você quiser parar o robô, é preciso enviar 0 para os motores, o comando é esse e pode ser executado diretamente no terminal:</p>
<div class="highlight"><pre><span></span><code>rostopic<span class="w"> </span>pub<span class="w"> </span>-1<span class="w"> </span>cmd_vel<span class="w"> </span>geometry_msgs/Twist<span class="w"> </span><span class="s1">&#39;[0.0, 0.0, 0.0]&#39;</span><span class="w"> </span><span class="s1">&#39;[0.0, 0.0, 0.0]&#39;</span>
</code></pre></div>
<p>Esse comando funciona tanto com o robô simulado quanto com o robô real e é muito útil para parar o robô em momentos de emergência. Se quiser facilitar a sua vida para futuros momentos caóticos de robô desgovernado, você pode criar um alias no seu arquivo robotica.sh.</p>
<p>Primeiro, abra o arquivo <em>robotica.sh</em> </p>
<div class="highlight"><pre><span></span><code>code<span class="w"> </span>/<span class="nv">$HOME</span>/robotica.sh
</code></pre></div>
<p>Depois, defina o alias que será o seu “comando de emergência” no arquivo robotica.sh, vou deixar um de exemplo aqui, mas você pode personalizar o seu.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Comando para parar o Insperbot</span>

<span class="nb">alias</span><span class="w"> </span><span class="nv">socorro</span><span class="o">=</span><span class="s2">&quot;rostopic pub -1 cmd_vel geometry_msgs/Twist &#39;[0.0, 0.0, 0.0]&#39; &#39;[0.0, 0.0, 0.0]&#39;&quot;</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Dica 4</p>
<p>Um <em>alias</em> é um apelido para um comando já existente. Quando digitarmos <em>socorro</em> no terminal o <em>bash</em> irá substituir por todo aquele comando.</p>
</div>
<p>Salve o arquivo, abra um terminal novo e teste o seu alias, ele será seu fiel companheiro. Lembre-se de que é preciso encerrar o código python que controla o robô para que não existam comandos concorrendo o controle do robô. </p>
<p><img alt="socorro.gif" src="imgs/socorro.gif" /></p>


</section>
          
        
      </main>
      <footer class="ah-footer ah-typeset">
        <div class="ah-footer-nav">
          
            <a href="../ssd-linux/git-e-github/"
               class="ah-prev"
               title="Configure o seu Git">
              <span class="nav-label">Anterior</span>
              <span class="nav-title">Configure o seu Git</span>
            </a>
          
          
            <a href="../turtlebot3/"
               class="ah-next"
               title="Conectando no robô físico">
              <span class="nav-label">Próximo</span>
              <span class="nav-title">Conectando no robô físico</span>
            </a>
          
        </div>
      </footer>
    </div>
    
      
    
  </body>
</html>